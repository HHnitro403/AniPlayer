<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="using:AniPlayer.UI"
             mc:Ignorable="d" d:DesignWidth="960" d:DesignHeight="600"
             x:Class="AniPlayer.UI.PlayerPage">

    <!-- Row 0: Video fills remaining space. Row 1: Controls in their own row.
         CRITICAL: Controls MUST stay in Row 1. NativeControlHost creates a native Win32 HWND
         in Row 0 that always paints on top of managed content in the same region, regardless
         of Avalonia z-order. Moving controls into Row 0 makes them invisible/non-interactive. -->
    <Grid x:Name="RootGrid" RowDefinitions="*,Auto">

        <!-- Video area (Row 0) â€” native window lives here -->
        <Grid x:Name="VideoContainer" Grid.Row="0" Background="Black">
            <local:VideoHost x:Name="VideoHostControl"/>
            <TextBlock x:Name="PlaceholderText"
                       Text="Open a video file to start playback"
                       Foreground="{DynamicResource TextSecondary}"
                       FontSize="16"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       TextAlignment="Center"/>
        </Grid>

        <!-- Overlay Grid for floating UI elements (spans both rows, renders ABOVE HWND region) -->
        <Grid Grid.RowSpan="2" IsHitTestVisible="False">
            <Button x:Name="SkipOverlayButton"
                    IsHitTestVisible="True"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Margin="0,0,30,100"
                    Padding="15,10"
                    Background="{DynamicResource BgElevated}"
                    Opacity="0.9"
                    Foreground="{DynamicResource TextPrimary}"
                    CornerRadius="5"
                    Focusable="False"
                    IsVisible="False"
                    Click="OnSkipButtonClick">
                <Button.Styles>
                    <Style Selector="Button:pointerover /template/ ContentPresenter">
                        <Setter Property="Background" Value="{DynamicResource BgSurface}"/>
                        <Setter Property="Foreground" Value="{DynamicResource AccentPrimary}"/>
                    </Style>
                </Button.Styles>
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <PathIcon Data="{StaticResource fast_forward_regular}" Width="16" Height="16"/>
                    <TextBlock x:Name="SkipButtonText" Text="Skip Intro" FontWeight="SemiBold"/>
                </StackPanel>
            </Button>
        </Grid>

        <!-- Modern Controls Bar (Row 1) â€” separate from native window, always accessible -->
        <StackPanel x:Name="ControlsBar" Grid.Row="1"
                    PointerEntered="OnControlsBarPointerEntered"
                    PointerExited="OnControlsBarPointerExited">
            
            <local:PlayerControls x:Name="PlayerControlsControl" />

            <!-- Track Selection (kept in PlayerPage for now but can be moved later) -->
            <Border Background="{DynamicResource BgSurface}" Padding="20,0,20,16">
                <Grid ColumnDefinitions="Auto,*,Auto,*">
                    <!-- Audio Tracks -->
                    <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                        <TextBlock Text="ðŸŽµ Audio:" Foreground="{DynamicResource TextSecondary}"
                                   FontSize="12" FontWeight="SemiBold" VerticalAlignment="Center"/>
                        <WrapPanel x:Name="AudioTracksPanel" VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Subtitle Tracks -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="8"
                                VerticalAlignment="Center" Margin="20,0,0,0">
                        <TextBlock Text="ðŸ’¬ Subtitles:" Foreground="{DynamicResource TextSecondary}"
                                   FontSize="12" FontWeight="SemiBold" VerticalAlignment="Center"/>
                        <WrapPanel x:Name="SubtitleTracksPanel" VerticalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </Border>
        </StackPanel>
    </Grid>
</UserControl>
